(()=>{"use strict";var t=1e-6,i="undefined"!=typeof Float32Array?Float32Array:Array;function e(){var t=new i(16);return i!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function s(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function o(t,i,e){var s=i[0],o=i[1],n=i[2],a=i[3],r=i[4],h=i[5],c=i[6],l=i[7],d=i[8],u=i[9],g=i[10],p=i[11],w=i[12],f=i[13],m=i[14],_=i[15],x=e[0],b=e[1],T=e[2],v=e[3];return t[0]=x*s+b*r+T*d+v*w,t[1]=x*o+b*h+T*u+v*f,t[2]=x*n+b*c+T*g+v*m,t[3]=x*a+b*l+T*p+v*_,x=e[4],b=e[5],T=e[6],v=e[7],t[4]=x*s+b*r+T*d+v*w,t[5]=x*o+b*h+T*u+v*f,t[6]=x*n+b*c+T*g+v*m,t[7]=x*a+b*l+T*p+v*_,x=e[8],b=e[9],T=e[10],v=e[11],t[8]=x*s+b*r+T*d+v*w,t[9]=x*o+b*h+T*u+v*f,t[10]=x*n+b*c+T*g+v*m,t[11]=x*a+b*l+T*p+v*_,x=e[12],b=e[13],T=e[14],v=e[15],t[12]=x*s+b*r+T*d+v*w,t[13]=x*o+b*h+T*u+v*f,t[14]=x*n+b*c+T*g+v*m,t[15]=x*a+b*l+T*p+v*_,t}Math.random,Math.PI,Math.hypot||(Math.hypot=function(){for(var t=0,i=arguments.length;i--;)t+=arguments[i]*arguments[i];return Math.sqrt(t)});var n;class a{static createShader(t,i,e){const s=t.createShader(i);if(t.shaderSource(s,e),t.compileShader(s),!t.getShaderParameter(s,t.COMPILE_STATUS)){const i=t.getShaderInfoLog(s);throw new Error("Shader compilation error: "+i)}return s}static createProgram(t,i,e){const s=t.createProgram();if(t.attachShader(s,i),t.attachShader(s,e),t.linkProgram(s),!t.getProgramParameter(s,t.LINK_STATUS)){const i=t.getProgramInfoLog(s);throw new Error("Could not compile WebGL program:"+i)}return s}static createBuffer(t,i,e){if(0==e.length)return null;if(!(e&&e.buffer instanceof ArrayBuffer&&void 0!==e.byteLength))return console.warn("Data is not an instance of ArrayBuffer"),null;const s=t.createBuffer();return t.bindBuffer(i,s),t.bufferData(i,e,t.STATIC_DRAW),s}static createVAO(t,...i){if(!(t instanceof WebGL2RenderingContext))return;const e=t.createVertexArray();let s,o;t.bindVertexArray(e);for(let e of i)null!=e.loc&&null!=e.loc&&(t.enableVertexAttribArray(e.loc),s=e.dimension,o=t.FLOAT,t.bindBuffer(t.ARRAY_BUFFER,e.buffer),t.vertexAttribPointer(e.loc,s,o,!1,0,0));return e}}class r{#t;position=[0,0,0];rotation=[0,0,0];scale=[1,1,1];static#i=0;#e=e();#s=[];#o=null;#n=null;#a=null;#r;#h;#c;#l;#d;#u=!0;get modelMatrix(){return this.#g(),this.#e}set useModelMatrix(t){if(!(t instanceof Boolean))throw new Error("useModelMatrix need to be a boolean value");this.#u=t}addAttribute(t,i,e=4){if(!(i instanceof Array))throw new Error("The info parameter needs to be a Array.");i.forEach((t=>{if("number"!=typeof t)throw new Error("The info array need to be numeric.")}));const s=i.length/e;if(this.#h){if(s!==this.#h)throw new Error("The VBOs need to contain the same number of vertex.")}else this.#h=s;const o=new Float32Array(i);this.#s.push({loc:this.#t.getAttribLocation(this.#a,t),buffer:a.createBuffer(this.#t,this.#t.ARRAY_BUFFER,o),dimension:e})}constructor(t,i,e,s){this.#r=s,this.#t=t,this.createShader(i,e)}createShader(t,i){this.#o=a.createShader(this.#t,this.#t.VERTEX_SHADER,t),this.#n=a.createShader(this.#t,this.#t.FRAGMENT_SHADER,i),this.#a=a.createProgram(this.#t,this.#o,this.#n),this.#t.useProgram(this.#a)}createVAO(){this.#c=a.createVAO(this.#t,...this.#s)}#g(){var t,i,e,o,n,a,r,h,c,l,d,u,g,p,w,f,m,_;s(this.#e),t=this.#e,i=this.#e,f=(e=this.position)[0],m=e[1],_=e[2],i===t?(t[12]=i[0]*f+i[4]*m+i[8]*_+i[12],t[13]=i[1]*f+i[5]*m+i[9]*_+i[13],t[14]=i[2]*f+i[6]*m+i[10]*_+i[14],t[15]=i[3]*f+i[7]*m+i[11]*_+i[15]):(o=i[0],n=i[1],a=i[2],r=i[3],h=i[4],c=i[5],l=i[6],d=i[7],u=i[8],g=i[9],p=i[10],w=i[11],t[0]=o,t[1]=n,t[2]=a,t[3]=r,t[4]=h,t[5]=c,t[6]=l,t[7]=d,t[8]=u,t[9]=g,t[10]=p,t[11]=w,t[12]=o*f+h*m+u*_+i[12],t[13]=n*f+c*m+g*_+i[13],t[14]=a*f+l*m+p*_+i[14],t[15]=r*f+d*m+w*_+i[15]),function(t,i,e){var s=Math.sin(e),o=Math.cos(e),n=i[4],a=i[5],r=i[6],h=i[7],c=i[8],l=i[9],d=i[10],u=i[11];i!==t&&(t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15]),t[4]=n*o+c*s,t[5]=a*o+l*s,t[6]=r*o+d*s,t[7]=h*o+u*s,t[8]=c*o-n*s,t[9]=l*o-a*s,t[10]=d*o-r*s,t[11]=u*o-h*s}(this.#e,this.#e,this.rotation[0]),function(t,i,e){var s=Math.sin(e),o=Math.cos(e),n=i[0],a=i[1],r=i[2],h=i[3],c=i[8],l=i[9],d=i[10],u=i[11];i!==t&&(t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15]),t[0]=n*o-c*s,t[1]=a*o-l*s,t[2]=r*o-d*s,t[3]=h*o-u*s,t[8]=n*s+c*o,t[9]=a*s+l*o,t[10]=r*s+d*o,t[11]=h*s+u*o}(this.#e,this.#e,this.rotation[1]),function(t,i,e){var s=Math.sin(e),o=Math.cos(e),n=i[0],a=i[1],r=i[2],h=i[3],c=i[4],l=i[5],d=i[6],u=i[7];i!==t&&(t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15]),t[0]=n*o+c*s,t[1]=a*o+l*s,t[2]=r*o+d*s,t[3]=h*o+u*s,t[4]=c*o-n*s,t[5]=l*o-a*s,t[6]=d*o-r*s,t[7]=u*o-h*s}(this.#e,this.#e,this.rotation[2]),function(t,i,e){var s=e[0],o=e[1],n=e[2];t[0]=i[0]*s,t[1]=i[1]*s,t[2]=i[2]*s,t[3]=i[3]*s,t[4]=i[4]*o,t[5]=i[5]*o,t[6]=i[6]*o,t[7]=i[7]*o,t[8]=i[8]*n,t[9]=i[9]*n,t[10]=i[10]*n,t[11]=i[11]*n,t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15]}(this.#e,this.#e,this.scale)}createTex(t,i){this.#l=this.#t.getUniformLocation(this.#a,i),this.#d=this.#t.createTexture(),this.#t.activeTexture(this.#t[`TEXTURE${r.#i}`]),this.#t.bindTexture(this.#t.TEXTURE_2D,this.#d),this.#t.texParameteri(this.#t.TEXTURE_2D,this.#t.TEXTURE_WRAP_S,this.#t.CLAMP_TO_EDGE),this.#t.texParameteri(this.#t.TEXTURE_2D,this.#t.TEXTURE_WRAP_T,this.#t.CLAMP_TO_EDGE),this.#t.texParameteri(this.#t.TEXTURE_2D,this.#t.TEXTURE_MIN_FILTER,this.#t.NEAREST),this.#t.texParameteri(this.#t.TEXTURE_2D,this.#t.TEXTURE_MAG_FILTER,this.#t.NEAREST),this.#t.texImage2D(this.#t.TEXTURE_2D,0,this.#t.RGBA32F,this.#t.RGBA,this.#t.FLOAT,t),this.#t.useProgram(this.#a),this.#t.uniform1i(this.#l,r.#i),r.#i++}setUniformValue(t,i,e){const s=this.#t.getUniformLocation(this.#a,t);if(-1===s)throw new Error("This uniform doesn't exist in the shader code.");this.#t.useProgram(this.#a),this.#t["uniform"+e](s,i)}draw(t){this.#t.frontFace(this.#t.CCW),this.#t.enable(this.#t.CULL_FACE),this.#t.cullFace(this.#t.BACK),this.#g(),this.#t.bindVertexArray(this.#c);const i=this.#u?this.#e:e();t&&o(i,t.viewProjection,i),this.#t.useProgram(this.#a);const s=this.#t.getUniformLocation(this.#a,"mvp");-1!==i&&this.#t.uniformMatrix4fv(s,!1,i),this.#t.drawArrays(this.#r,0,this.#h),this.#t.disable(this.#t.CULL_FACE)}}n=new i(3),i!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0);class h{#p;#w;#f;set scaleX(t){if(t<=0)throw new Error("the scale of a image need to be greater than 0");this.#p.scale[0]=t}set scaleY(t){if(t<=0)throw new Error("the scale of a image need to be greater than 0");this.#p.scale[1]=t}set positionX(t){this.#p.position[0]=t}set positionY(t){this.#p.position[1]=t}set depth(t){this.#p.position[2]=t}set rotation(t){this.#p.rotation[2]=t}set scale(t){if(!(t instanceof Array)||2!==t.length)throw new Error("scale need to be a vector with two positions.");this.#p.scale=function(t,e,s){var o=new i(3);return o[0]=t,o[1]=e,o[2]=1,o}(t[0],t[1])}set opacity(t){this.#p.setUniformValue("alpha",t,"1f")}get positionX(){return this.#p.position[0]}get positionY(){return this.#p.position[1]}async init(t,i){this.#p=new r(t,"#version 300 es\n    precision highp float;\n\n    uniform mat4 mvp;\n\n    in vec4 position;\n    in vec2 texCoord;\n\n    out vec2 fTexCoord;\n\n    void main() {\n        gl_Position  = mvp * position;\n        fTexCoord = texCoord;\n    }\n","#version 300 es\n    precision highp float;\n    \n    in vec2 fTexCoord;\n\n    uniform sampler2D uTexture;\n    uniform float alpha;\n\n    out vec4 color;\n\n\n\n    void main() {\n        color = texture(uTexture, fTexCoord);\n\n        if(color.a < 0.5) discard;\n\n        color *= alpha;\n    }\n",t.TRIANGLES);const e=await this.#m(i),s=this.#_(...e);this.#p.addAttribute("position",s.coords),this.#p.addAttribute("texCoord",s.texCoords,2),this.#p.createVAO(),this.opacity=1}async loadImage(t){return new Promise((i=>{const e=new Image;e.addEventListener("load",(()=>{i(e)})),e.src=t}))}async#m(t){const i=await this.loadImage(t);await i.decode();const e=await createImageBitmap(i);return this.#p.createTex(i,"uTexture"),[e.width,e.height]}#_(t,i){const e=t/i;let s=1,o=1;e<1?s*=e:o/=e,this.#w=s,this.#f=o;const n=[-s,-o,0,1],a=[s,-o,0,1],r=[s,o,0,1],h=[-s,o,0,1];return{coords:[...n,...a,...r,...n,...r,...h],texCoords:[0,1,1,1,1,0,0,1,1,0,0,0]}}pointCollision(t,i,s){const n=[t,i,0,1],a=e();(function(t,i){t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t[4]=i[4],t[5]=i[5],t[6]=i[6],t[7]=i[7],t[8]=i[8],t[9]=i[9],t[10]=i[10],t[11]=i[11],t[12]=i[12],t[13]=i[13],t[14]=i[14],t[15]=i[15]})(a,this.#p.modelMatrix),s&&o(a,s.viewProjection,a);const r=e();!function(t,i){var e=i[0],s=i[1],o=i[2],n=i[3],a=i[4],r=i[5],h=i[6],c=i[7],l=i[8],d=i[9],u=i[10],g=i[11],p=i[12],w=i[13],f=i[14],m=i[15],_=e*r-s*a,x=e*h-o*a,b=e*c-n*a,T=s*h-o*r,v=s*c-n*r,E=o*c-n*h,M=l*w-d*p,A=l*f-u*p,P=l*m-g*p,y=d*f-u*w,S=d*m-g*w,R=u*m-g*f,L=_*R-x*S+b*y+T*P-v*A+E*M;L&&(L=1/L,t[0]=(r*R-h*S+c*y)*L,t[1]=(o*S-s*R-n*y)*L,t[2]=(w*E-f*v+m*T)*L,t[3]=(u*v-d*E-g*T)*L,t[4]=(h*P-a*R-c*A)*L,t[5]=(e*R-o*P+n*A)*L,t[6]=(f*b-p*E-m*x)*L,t[7]=(l*E-u*b+g*x)*L,t[8]=(a*S-r*P+c*M)*L,t[9]=(s*P-e*S-n*M)*L,t[10]=(p*v-w*b+m*_)*L,t[11]=(d*b-l*v-g*_)*L,t[12]=(r*A-a*y-h*M)*L,t[13]=(e*y-s*A+o*M)*L,t[14]=(w*x-p*T-f*_)*L,t[15]=(l*T-d*x+u*_)*L)}(r,a);const h=function(t,i){const e=new Array(i.length).fill(0);if(Math.round(i.length**2)===t.length){for(let s=0;s<i.length;s++)for(let o=0;o<t.length;o+=4)e[s]+=t[o+s]*i[o/4];return e}}(r,n);return Math.abs(h[0])<this.#w&&Math.abs(h[1])<this.#f}draw(t){this.#p&&this.#p.draw(t)}}class c{#x=e();#b=e();#T=e();camPosition=[0,0,1];lookDirection=[0,0,0];upDirection=[0,1,0];left=-4;right=4;bottom=-4;top=4;near=1;far=9;fovy=Math.PI/1.3;aspect;constructor(t){this.aspect=t.width/t.height}#v="perspective";set projectionType(t){if("orthogonal"!==t&&"perspective"!==t)throw new Error("Invalid type of projection.");this.typeOfProjection=t}get viewMatrix(){return this.#E(),this.#x}get projMatrix(){return this.#M(),this.#b}#E(){s(this.#x),function(i,e,o,n){var a,r,h,c,l,d,u,g,p,w,f=e[0],m=e[1],_=e[2],x=n[0],b=n[1],T=n[2],v=o[0],E=o[1],M=o[2];Math.abs(f-v)<t&&Math.abs(m-E)<t&&Math.abs(_-M)<t?s(i):(u=f-v,g=m-E,p=_-M,a=b*(p*=w=1/Math.hypot(u,g,p))-T*(g*=w),r=T*(u*=w)-x*p,h=x*g-b*u,(w=Math.hypot(a,r,h))?(a*=w=1/w,r*=w,h*=w):(a=0,r=0,h=0),c=g*h-p*r,l=p*a-u*h,d=u*r-g*a,(w=Math.hypot(c,l,d))?(c*=w=1/w,l*=w,d*=w):(c=0,l=0,d=0),i[0]=a,i[1]=c,i[2]=u,i[3]=0,i[4]=r,i[5]=l,i[6]=g,i[7]=0,i[8]=h,i[9]=d,i[10]=p,i[11]=0,i[12]=-(a*f+r*m+h*_),i[13]=-(c*f+l*m+d*_),i[14]=-(u*f+g*m+p*_),i[15]=1)}(this.#x,this.camPosition,this.lookDirection,this.upDirection)}#M(){s(this.#b),"perspective"==this.typeOfProjection?function(t,i,e,s,o){var n,a=1/Math.tan(i/2);t[0]=a/e,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=o&&o!==1/0?(n=1/(s-o),t[10]=(o+s)*n,t[14]=2*o*s*n):(t[10]=-1,t[14]=-2*s)}(this.#b,this.fovy,this.aspect,this.near,this.far):function(t,i,e,s,o,n,a){var r=1/(i-e),h=1/(s-o),c=1/(n-a);t[0]=-2*r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*h,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(i+e)*r,t[13]=(o+s)*h,t[14]=(a+n)*c,t[15]=1}(this.#b,this.left,this.right,this.bottom,this.top,this.left,this.right)}get viewProjection(){return this.#E(),this.#M(),s(this.#T),o(this.#T,this.#b,this.#x),this.#T}}const l=document.querySelector("#game-screen");let d=0;const u=l.getContext("webgl2");u.viewport(0,0,u.canvas.width,u.canvas.height),u.clearColor(0,0,0,1),u.clear(u.COLOR_BUFFER_BIT|u.DEPTH_BUFFER_BIT);class g{async init(){this.show_cards=new h,await this.show_cards.init(u,"./assets/game/show_cards.png"),this.show_cards.scale=[1.7,3],console.log(this.show_cards.positionX),g.setInitialPosition(this.show_cards.positionX,-3.355-this.show_cards.width,.3,this.show_cards),this.cancel_button=new h,await this.cancel_button.init(u,"./assets/game/cancel_button.png"),this.cancel_button.scale=[.27,.48],g.setInitialPosition(-1.42,-3.2-this.show_cards.width,.4,this.cancel_button),this.ok_button=new h,await this.ok_button.init(u,"./assets/game/ok_button.png"),this.ok_button.scale=[.27,.48],g.setInitialPosition(1.42,-3.2-this.show_cards.width,.4,this.ok_button),this.cards_info=new h,await this.cards_info.init(u,"assets/game/cards_info.png"),this.cards_info.scale=[.8,1.35],g.setInitialPosition(3.35+this.cards_info.width,this.cards_info.positionY,.3,this.cards_info)}static setInitialPosition(t,i,e,s){s.positionX=t,s.positionY=i,s.depth=e}moveAll(t,i){this.show_cards.positionY+=i,this.cancel_button.positionY+=i,this.ok_button.positionY+=i,this.cards_info.positionX+=t}draw(t){this.show_cards.draw(t),this.cancel_button.draw(t),this.ok_button.draw(t),this.cards_info.draw(t)}}class p{async init(){this.fortify=new h,await this.fortify.init(u,"./assets/game/fortify.png"),this.fortify.scale=[1.7,3],p.setInitialPosition(this.fortify.positionX,-3.25,.3,this.fortify),this.cancel_button=new h,await this.cancel_button.init(u,"./assets/game/cancel_button.png"),this.cancel_button.scale=[.27,.48],g.setInitialPosition(1.42,-3.2,.4,this.cancel_button),this.ok_button=new h,await this.ok_button.init(u,"./assets/game/ok_button.png"),this.ok_button.scale=[.27,.48],g.setInitialPosition(1.42,-3.2,.4,this.ok_button)}static setInitialPosition(t,i,e,s){s.positionX=t,s.positionY=i,s.depth=e}moveAll(t){this.fortify.positionY+=t,this.cancel_button.positionY+=t,this.ok_button.positionY+=t}draw(t){this.fortify.draw(t),this.cancel_button.draw(t),this.ok_button.draw(t)}}!async function(t){const i=new h;await i.init(t,"./assets/menu/fundo.jpg");const e=new h;await e.init(t,"./assets/menu/logo_war.png");const s=new h;await s.init(t,"./assets/menu/play_button.png");const o=new h;await o.init(t,"./assets/menu/settings_button.png");const n=new h;await n.init(t,"./assets/menu/max_button.png"),i.scale=[4,7.3],e.scale=[1.35,2],s.scale=[.65,1.1],o.scale=[.15,.27],n.scale=[.15,.27],e.positionY=.25,s.positionY=-1.9,o.positionX=3.7,o.positionY=2.8,n.positionX=3.7,n.positionY=3.5;const a=new c(t.canvas);t.enable(t.DEPTH_TEST),t.depthFunc(t.LESS),e.draw(a),s.draw(a),o.draw(a),n.draw(a),i.draw(a),t.disable(t.DEPTH_TEST),l.addEventListener("click",(i=>{const e=function(t,i,e){const s=[t-e.offsetLeft-e.width/2,e.height/2-(i-e.offsetTop)];return[2*s[0]/e.width,2*s[1]/e.height]}(i.clientX,i.clientY,l);s.pointCollision(...e,a)&&(d=1,async function(t){const i=new h;await i.init(t,"./assets/mapa.jpg");const e=new h;await e.init(t,"./assets/menu/settings_button.png");const s=new h;await s.init(t,"./assets/menu/max_button.png");const o=new h;await o.init(t,"./assets/game/card_button.png");const n=new h;await n.init(t,"./assets/game/objective_button.png");const a=new h;await a.init(t,"./assets/game/current_player.png");const r=new h;await r.init(t,"./assets/game/show_players.png");const d=new g;await d.init();const u=new p;await u.init(),e.scale=[.15,.27],s.scale=[.15,.27],o.scale=[.5,.8],n.scale=[.47,.8],a.scale=[1.5,2.5],i.scale=[4,7.4],r.scale=[.47,.8],e.positionX=3.7,e.positionY=2.8,e.depth=.2,s.positionX=3.7,s.positionY=3.5,s.depth=.2,o.positionX=2.9,o.positionY=-3.2,o.depth=.2,n.positionX=3.6,n.positionY=-3.2,n.depth=.2,r.positionX=-3.6,r.positionY=-3.2,r.depth=.2,a.positionY=-3.375,a.depth=.2;const w=new c(l);let f=!1;t.enable(t.DEPTH_TEST),t.depthFunc(t.LESS),i.draw(w),e.draw(w),o.draw(w),n.draw(w),a.draw(w),s.draw(w),r.draw(w),d.draw(w),t.disable(t.DEPTH_TEST);let m=0,_=0;l.addEventListener("mousedown",(t=>{m=t.clientX,_=t.clientY,f=!0})),l.addEventListener("mouseup",(t=>{f=!1,console.log(m,_)})),l.addEventListener("mousemove",(t=>{if(f){let i=t.clientX-m,e=t.clientY-_;console.log(i,e)}}))}(t)),n.pointCollision(...e,a)&&alert("FullScreen")}))}(u)})();
//# sourceMappingURL=main.bundle.js.map