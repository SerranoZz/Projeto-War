(()=>{"use strict";var t=1e-6,e="undefined"!=typeof Float32Array?Float32Array:Array;function r(){var t=new e(16);return e!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function i(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function o(t,e,r){var i=e[0],o=e[1],a=e[2],s=e[3],n=e[4],h=e[5],c=e[6],l=e[7],u=e[8],g=e[9],m=e[10],d=e[11],f=e[12],p=e[13],x=e[14],T=e[15],w=r[0],M=r[1],v=r[2],E=r[3];return t[0]=w*i+M*n+v*u+E*f,t[1]=w*o+M*h+v*g+E*p,t[2]=w*a+M*c+v*m+E*x,t[3]=w*s+M*l+v*d+E*T,w=r[4],M=r[5],v=r[6],E=r[7],t[4]=w*i+M*n+v*u+E*f,t[5]=w*o+M*h+v*g+E*p,t[6]=w*a+M*c+v*m+E*x,t[7]=w*s+M*l+v*d+E*T,w=r[8],M=r[9],v=r[10],E=r[11],t[8]=w*i+M*n+v*u+E*f,t[9]=w*o+M*h+v*g+E*p,t[10]=w*a+M*c+v*m+E*x,t[11]=w*s+M*l+v*d+E*T,w=r[12],M=r[13],v=r[14],E=r[15],t[12]=w*i+M*n+v*u+E*f,t[13]=w*o+M*h+v*g+E*p,t[14]=w*a+M*c+v*m+E*x,t[15]=w*s+M*l+v*d+E*T,t}Math.random,Math.PI,Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});var a;class s{static createShader(t,e,r){const i=t.createShader(e);if(t.shaderSource(i,r),t.compileShader(i),!t.getShaderParameter(i,t.COMPILE_STATUS)){const e=t.getShaderInfoLog(i);throw new Error("Shader compilation error: "+e)}return i}static createProgram(t,e,r){const i=t.createProgram();if(t.attachShader(i,e),t.attachShader(i,r),t.linkProgram(i),!t.getProgramParameter(i,t.LINK_STATUS)){const e=t.getProgramInfoLog(i);throw new Error("Could not compile WebGL program:"+e)}return i}static createBuffer(t,e,r){if(0==r.length)return null;if(!(r&&r.buffer instanceof ArrayBuffer&&void 0!==r.byteLength))return console.warn("Data is not an instance of ArrayBuffer"),null;const i=t.createBuffer();return t.bindBuffer(e,i),t.bufferData(e,r,t.STATIC_DRAW),i}static createVAO(t,...e){if(!(t instanceof WebGL2RenderingContext))return;const r=t.createVertexArray();let i,o;t.bindVertexArray(r);for(let r of e)null!=r.loc&&null!=r.loc&&(t.enableVertexAttribArray(r.loc),i=r.dimension,o=t.FLOAT,t.bindBuffer(t.ARRAY_BUFFER,r.buffer),t.vertexAttribPointer(r.loc,i,o,!1,0,0));return r}}class n{#t;position=[0,0,0];rotation=[0,0,0];scale=[1,1,1];static#e=0;#r=r();#i=[];#o=null;#a=null;#s=null;#n;#h;#c;#l;#u;#g=!0;set useModelMatrix(t){if(!(t instanceof Boolean))throw new Error("useModelMatrix need to be a boolean value");this.#g=t}addAttribute(t,e,r=4){if(!(e instanceof Array))throw new Error("The info parameter needs to be a Array.");e.forEach((t=>{if("number"!=typeof t)throw new Error("The info array need to be numeric.")}));const i=e.length/r;if(this.#h){if(i!==this.#h)throw new Error("The VBOs need to contain the same number of vertex.")}else this.#h=i;const o=new Float32Array(e);this.#i.push({loc:this.#t.getAttribLocation(this.#s,t),buffer:s.createBuffer(this.#t,this.#t.ARRAY_BUFFER,o),dimension:r})}constructor(t,e,r,i){this.#n=i,this.#t=t,this.createShader(e,r)}createShader(t,e){this.#o=s.createShader(this.#t,this.#t.VERTEX_SHADER,t),this.#a=s.createShader(this.#t,this.#t.FRAGMENT_SHADER,e),this.#s=s.createProgram(this.#t,this.#o,this.#a),this.#t.useProgram(this.#s)}createVAO(){this.#c=s.createVAO(this.#t,...this.#i)}#m(){var t,e,r,o,a,s,n,h,c,l,u,g,m,d,f,p,x,T;i(this.#r),t=this.#r,e=this.#r,p=(r=this.position)[0],x=r[1],T=r[2],e===t?(t[12]=e[0]*p+e[4]*x+e[8]*T+e[12],t[13]=e[1]*p+e[5]*x+e[9]*T+e[13],t[14]=e[2]*p+e[6]*x+e[10]*T+e[14],t[15]=e[3]*p+e[7]*x+e[11]*T+e[15]):(o=e[0],a=e[1],s=e[2],n=e[3],h=e[4],c=e[5],l=e[6],u=e[7],g=e[8],m=e[9],d=e[10],f=e[11],t[0]=o,t[1]=a,t[2]=s,t[3]=n,t[4]=h,t[5]=c,t[6]=l,t[7]=u,t[8]=g,t[9]=m,t[10]=d,t[11]=f,t[12]=o*p+h*x+g*T+e[12],t[13]=a*p+c*x+m*T+e[13],t[14]=s*p+l*x+d*T+e[14],t[15]=n*p+u*x+f*T+e[15]),function(t,e,r){var i=Math.sin(r),o=Math.cos(r),a=e[4],s=e[5],n=e[6],h=e[7],c=e[8],l=e[9],u=e[10],g=e[11];e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=a*o+c*i,t[5]=s*o+l*i,t[6]=n*o+u*i,t[7]=h*o+g*i,t[8]=c*o-a*i,t[9]=l*o-s*i,t[10]=u*o-n*i,t[11]=g*o-h*i}(this.#r,this.#r,this.rotation[0]),function(t,e,r){var i=Math.sin(r),o=Math.cos(r),a=e[0],s=e[1],n=e[2],h=e[3],c=e[8],l=e[9],u=e[10],g=e[11];e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*o-c*i,t[1]=s*o-l*i,t[2]=n*o-u*i,t[3]=h*o-g*i,t[8]=a*i+c*o,t[9]=s*i+l*o,t[10]=n*i+u*o,t[11]=h*i+g*o}(this.#r,this.#r,this.rotation[1]),function(t,e,r){var i=Math.sin(r),o=Math.cos(r),a=e[0],s=e[1],n=e[2],h=e[3],c=e[4],l=e[5],u=e[6],g=e[7];e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*o+c*i,t[1]=s*o+l*i,t[2]=n*o+u*i,t[3]=h*o+g*i,t[4]=c*o-a*i,t[5]=l*o-s*i,t[6]=u*o-n*i,t[7]=g*o-h*i}(this.#r,this.#r,this.rotation[2]),function(t,e,r){var i=r[0],o=r[1],a=r[2];t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i,t[3]=e[3]*i,t[4]=e[4]*o,t[5]=e[5]*o,t[6]=e[6]*o,t[7]=e[7]*o,t[8]=e[8]*a,t[9]=e[9]*a,t[10]=e[10]*a,t[11]=e[11]*a,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]}(this.#r,this.#r,this.scale)}createTex(t,e){this.#l=this.#t.getUniformLocation(this.#s,e),this.#u=this.#t.createTexture(),this.#t.activeTexture(this.#t[`TEXTURE${n.#e}`]),this.#t.bindTexture(this.#t.TEXTURE_2D,this.#u),this.#t.texParameteri(this.#t.TEXTURE_2D,this.#t.TEXTURE_WRAP_S,this.#t.CLAMP_TO_EDGE),this.#t.texParameteri(this.#t.TEXTURE_2D,this.#t.TEXTURE_WRAP_T,this.#t.CLAMP_TO_EDGE),this.#t.texParameteri(this.#t.TEXTURE_2D,this.#t.TEXTURE_MIN_FILTER,this.#t.NEAREST),this.#t.texParameteri(this.#t.TEXTURE_2D,this.#t.TEXTURE_MAG_FILTER,this.#t.NEAREST),this.#t.texImage2D(this.#t.TEXTURE_2D,0,this.#t.RGBA32F,this.#t.RGBA,this.#t.FLOAT,t),this.#t.useProgram(this.#s),this.#t.uniform1i(this.#l,n.#e),console.log(n.#e),n.#e++}setUniformValue(t,e,r){const i=this.#t.getUniformLocation(this.#s,t);if(-1===i)throw new Error("This uniform doesn't exist in the shader code.");this.#t.useProgram(this.#s),this.#t["uniform"+r](i,e)}draw(t){this.#t.frontFace(this.#t.CCW),this.#t.enable(this.#t.CULL_FACE),this.#t.cullFace(this.#t.BACK),this.#m();const e=this.#g?this.#r:r();t&&o(e,t.viewProjection,e),this.#t.useProgram(this.#s);const i=this.#t.getUniformLocation(this.#s,"mvp");-1!==e&&this.#t.uniformMatrix4fv(i,!1,e),this.#t.drawArrays(this.#n,0,this.#h),this.#t.disable(this.#t.CULL_FACE)}}a=new e(3),e!=Float32Array&&(a[0]=0,a[1]=0,a[2]=0);class h{#d;set scaleX(t){if(t<=0)throw new Error("the scale of a image need to be greater than 0");this.#d.scale[0]=t}set scaleY(t){if(t<=0)throw new Error("the scale of a image need to be greater than 0");this.#d.scale[1]=t}set positionX(t){this.#d.position[0]=t}set positionY(t){this.#d.position[1]=t}set depth(t){this.#d.position[2]=t}set rotation(t){this.#d.rotation[2]=t}set scale(t){if(!(t instanceof Array)||2!==t.length)throw new Error("scale need to be a vector with two positions.");this.#d.scale=function(t,r,i){var o=new e(3);return o[0]=t,o[1]=r,o[2]=1,o}(t[0],t[1])}set opacity(t){this.#d.setUniformValue("alpha",t,"1f")}async init(t,e){this.#d=new n(t,"#version 300 es\n    precision highp float;\n\n    uniform mat4 mvp;\n\n    in vec4 position;\n    in vec2 texCoord;\n\n    out vec2 fTexCoord;\n\n    void main() {\n        gl_Position  = mvp * position;\n        fTexCoord = texCoord;\n    }\n","#version 300 es\n    precision highp float;\n    \n    in vec2 fTexCoord;\n\n    uniform sampler2D uTexture;\n    uniform float alpha;\n\n    out vec4 color;\n\n\n\n    void main() {\n        color = texture(uTexture, fTexCoord);\n\n        if(color.a < 0.5) discard;\n\n        color.a = alpha;\n    }\n",t.TRIANGLES);const r=await this.#f(e),i=this.#p(...r);this.#d.addAttribute("position",i.coords),this.#d.addAttribute("texCoord",i.texCoords,2),this.#d.createVAO(),this.opacity=1}async#f(t){const e=document.createElement("img");e.src=t,await e.decode();const r=await createImageBitmap(e);return this.#d.createTex(e,"uTexture"),[r.width,r.height]}#p(t,e){const r=t/e;let i=1,o=1;r<1?i*=r:o/=r;const a=[-i,-o,0,1],s=[i,-o,0,1],n=[i,o,0,1],h=[-i,o,0,1];return{coords:[...a,...s,...n,...a,...n,...h],texCoords:[0,1,1,1,1,0,0,1,1,0,0,0]}}draw(t){this.#d&&this.#d.draw(t)}}class c{#x=r();#T=r();#w=r();camPosition=[0,0,1];lookDirection=[0,0,0];upDirection=[0,1,0];left=-4;right=4;bottom=-4;top=4;near=1;far=9;fovy=Math.PI/1.7;aspect;constructor(t){this.aspect=t.width/t.height}#M="perspective";set projectionType(t){if("orthogonal"!==t&&"perspective"!==t)throw new Error("Invalid type of projection.");this.typeOfProjection=t}get viewMatrix(){return this.#v(),this.#x}get projMatrix(){return this.#E(),this.#T}#v(){i(this.#x),function(e,r,o,a){var s,n,h,c,l,u,g,m,d,f,p=r[0],x=r[1],T=r[2],w=a[0],M=a[1],v=a[2],E=o[0],A=o[1],P=o[2];Math.abs(p-E)<t&&Math.abs(x-A)<t&&Math.abs(T-P)<t?i(e):(g=p-E,m=x-A,d=T-P,s=M*(d*=f=1/Math.hypot(g,m,d))-v*(m*=f),n=v*(g*=f)-w*d,h=w*m-M*g,(f=Math.hypot(s,n,h))?(s*=f=1/f,n*=f,h*=f):(s=0,n=0,h=0),c=m*h-d*n,l=d*s-g*h,u=g*n-m*s,(f=Math.hypot(c,l,u))?(c*=f=1/f,l*=f,u*=f):(c=0,l=0,u=0),e[0]=s,e[1]=c,e[2]=g,e[3]=0,e[4]=n,e[5]=l,e[6]=m,e[7]=0,e[8]=h,e[9]=u,e[10]=d,e[11]=0,e[12]=-(s*p+n*x+h*T),e[13]=-(c*p+l*x+u*T),e[14]=-(g*p+m*x+d*T),e[15]=1)}(this.#x,this.camPosition,this.lookDirection,this.upDirection)}#E(){i(this.#T),"perspective"==this.typeOfProjection?function(t,e,r,i,o){var a,s=1/Math.tan(e/2);t[0]=s/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=o&&o!==1/0?(a=1/(i-o),t[10]=(o+i)*a,t[14]=2*o*i*a):(t[10]=-1,t[14]=-2*i)}(this.#T,this.fovy,this.aspect,this.near,this.far):function(t,e,r,i,o,a,s){var n=1/(e-r),h=1/(i-o),c=1/(a-s);t[0]=-2*n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*h,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+r)*n,t[13]=(o+i)*h,t[14]=(s+a)*c,t[15]=1}(this.#T,1024*this.left/768,1024*this.right/768,this.bottom,this.top,this.left,this.right)}get viewProjection(){return this.#v(),this.#E(),i(this.#w),o(this.#w,this.#T,this.#x),this.#w}}!async function(t){if(!(t instanceof HTMLCanvasElement))return;const e=t.getContext("webgl2",{premultipliedalpha:!1}),r=window.devicePixelRatio||1;e.canvas.width=1024*r,e.canvas.height=768*r,e.viewport(0,0,e.canvas.width,e.canvas.height),e.clearColor(0,0,0,1),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT);const i=new h;await i.init(e,"./assets/fundo war.jpg"),i.scale=[10,5];const o=new h;await o.init(e,"./assets/bowser.png"),o.rotation=Math.PI,o.positionX=2;const a=new c(t);a.typeOfProjection="orthogonal",e.enable(e.DEPTH_TEST),e.depthFunc(e.LESS),o.draw(a),i.draw(a),e.disable(e.DEPTH_TEST)}(document.querySelector("#game-screen"))})();
//# sourceMappingURL=main.bundle.js.map